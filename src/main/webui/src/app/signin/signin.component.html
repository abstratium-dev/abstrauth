<div>
    @if(!getApproval){
        <h1>Sign in</h1>

        @if(errorMessage){
            <p class="error">
                {{ errorMessage }}
            </p>
        }

        <form [formGroup]="signinForm" (ngSubmit)="signin()">
            <div class="form-group">
                <input type='text' formControlName='username' placeholder='Username' required/>
                <div *ngIf="signinForm.get('username')?.invalid && signinForm.get('username')?.touched" class="error">
                    <span *ngIf="signinForm.get('username')?.hasError('required')">Username is required</span>
                </div>
            </div>
            
            <div class="form-group">
                <input type='password' formControlName='password' placeholder='Password' required/>
                <div *ngIf="signinForm.get('password')?.invalid && signinForm.get('password')?.touched" class="error">
                    <span *ngIf="signinForm.get('password')?.hasError('required')">Password is required</span>
                </div>
            </div>
            
            <button type='submit' [disabled]="isSubmitting">{{ isSubmitting ? 'Signing in...' : 'Sign in' }}</button>
        </form>
        
        <p style='text-align:center;margin-top:20px;'>
            Don't have an account? <a href='/signup/{{requestId}}'>Sign up</a>
        </p>
    } @else {
        <h1>Approve Application</h1>

        @if(errorMessage){
            <p class="error">
                {{ errorMessage }}
            </p>
        }

        <p>Hi {{ name }}, <strong>{{ clientName }}</strong> wants to access:</p>
        <ul>
            @for(scope of scopes; track scope){
                <li>{{ scope }}</li>
            }
        </ul>

        <!-- use old skool form, so that browser will redirect to callback and we stay rfc compliant -->
        <form method='post' action='/oauth2/authorize'>
            <input type='hidden' name='request_id' value='{{ requestId }}'/>
            <button type='submit' name='consent' value='approve'>Approve</button>
            <button type='submit' name='consent' value='deny'>Deny</button>
        </form>
    }
</div>
